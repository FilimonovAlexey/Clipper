# Tahoe - macOS Clipboard Manager

Нативное macOS приложение для управления историей буфера обмена, работающее из menu bar.

## Возможности

✅ **Menu Bar интеграция** - компактный доступ из статус-бара
✅ **Автоматический мониторинг** - отслеживание всех текстовых копий
✅ **История до 500 элементов** - настраиваемый лимит
✅ **Поиск в реальном времени** - мгновенная фильтрация истории
✅ **Закрепление элементов** - pin важных записей
✅ **Горячие клавиши** - быстрый доступ с клавиатуры
✅ **Темная/светлая тема** - следует системным настройкам
✅ **Персистентность** - история сохраняется между запусками

## Системные требования

- macOS 13.0 (Ventura) или новее
- Xcode 15.0+ для сборки

## Установка и запуск

### 1. Создание Xcode проекта

1. Откройте Xcode
2. Выберите **File → New → Project**
3. Выберите **macOS → App**
4. Настройки проекта:
   - **Product Name:** Tahoe
   - **Interface:** SwiftUI
   - **Language:** Swift
   - **Bundle Identifier:** com.yourname.Tahoe (измените на свой)
5. Сохраните проект

### 2. Импорт исходного кода

1. Удалите файлы по умолчанию из проекта (ContentView.swift, если есть)
2. Скопируйте всю структуру TahoeApp/ в директорию проекта
3. Добавьте файлы в проект:
   - Правый клик на проект → **Add Files to "Tahoe"**
   - Выберите все папки (Models, Views, ViewModels, Services)
   - Убедитесь, что выбрано **"Copy items if needed"** и **"Create groups"**

### 3. Настройка Info.plist

В Xcode:
1. Выберите проект в навигаторе
2. Выберите Target "Tahoe"
3. Перейдите на вкладку **Info**
4. Добавьте новый ключ:
   - **Key:** Application is agent (UIElement) (`LSUIElement`)
   - **Type:** Boolean
   - **Value:** YES

Или замените содержимое Info.plist предоставленным файлом.

### 4. Настройка Entitlements

1. Выберите Target "Tahoe"
2. Перейдите на вкладку **Signing & Capabilities**
3. Убедитесь, что **App Sandbox** ВЫКЛЮЧЕН (или удалите capability)
4. Добавьте файл `Tahoe.entitlements` в проект

### 5. Установка Deployment Target

1. Выберите Target "Tahoe"
2. **General → Minimum Deployments**
3. Установите **macOS 13.0** или выше

### 6. Сборка и запуск

1. Выберите схему **Tahoe** и **My Mac**
2. Нажмите **⌘R** или **Product → Run**
3. Приложение появится в menu bar (правый верхний угол)

## Использование

### Основные действия

- **Клик на иконку** - открыть/закрыть окно истории
- **Клик на элемент** - скопировать в буфер обмена
- **Hover на элемент** - показать полный текст и кнопки действий
- **Pin кнопка** - закрепить элемент вверху списка
- **Trash кнопка** - удалить элемент
- **Поиск** - вводите текст для фильтрации

### Горячие клавиши

- **⌘⇧V** - Открыть/закрыть Tahoe
- **⌘⇧C** - Очистить всю историю
- **ESC** - Закрыть окно

### Настройки

Нажмите кнопку **Settings** в футере окна:

- **History Limit** - количество сохраняемых элементов (50-500)
- **Launch at Login** - автозапуск при входе в систему
- **Appearance** - System/Light/Dark тема

## Архитектура проекта

```
TahoeApp/
├── TahoeApp.swift           # Главный файл приложения с AppDelegate
├── Models/
│   ├── ClipboardItem.swift  # Модель элемента истории
│   └── AppSettings.swift    # Настройки приложения
├── ViewModels/
│   └── ClipboardManager.swift  # Управление историей и логика
├── Views/
│   ├── MenuBarView.swift       # Главное окно popover
│   ├── ClipboardItemRow.swift  # Строка элемента списка
│   ├── SearchBar.swift         # Компонент поиска
│   └── SettingsView.swift      # Окно настроек
├── Services/
│   ├── PasteboardMonitor.swift  # Мониторинг NSPasteboard
│   ├── StorageManager.swift     # Сохранение/загрузка JSON
│   └── HotKeyManager.swift      # Глобальные горячие клавиши
└── Resources/
    └── (иконки, если добавите)
```

## Технические детали

### Паттерны и архитектура

- **MVVM** - Model-View-ViewModel архитектура
- **Combine** - реактивное управление состоянием
- **@Published** - автоматическое обновление UI
- **ObservableObject** - центральное хранилище данных

### Ключевые компоненты

1. **PasteboardMonitor** - Polling NSPasteboard каждые 0.5 сек
2. **StorageManager** - JSON персистентность в Application Support
3. **HotKeyManager** - Carbon Events API для глобальных хоткеев
4. **ClipboardManager** - Главный ViewModel с бизнес-логикой

### Оптимизация производительности

- Lazy loading для больших списков (LazyVStack)
- Автоматическое удаление дубликатов
- Лимит истории для контроля памяти
- Эффективный polling без блокировки UI

## Возможные улучшения

### Будущие фичи (не реализованы в MVP)

- [ ] Поддержка изображений и файлов
- [ ] Категории и теги для элементов
- [ ] Экспорт истории в CSV/TXT
- [ ] Snippets с плейсхолдерами
- [ ] Синхронизация через iCloud
- [ ] Игнорирование конфиденциальных данных (пароли)
- [ ] Статистика использования
- [ ] Кастомизация горячих клавиш в UI
- [ ] Rich text форматирование
- [ ] Drag & drop для элементов

### Известные ограничения

- Только текстовый контент (no images/files)
- Горячие клавиши захардкожены
- Launch at login требует дополнительной настройки SMAppService
- Нет end-to-end шифрования для sensitive data

## Troubleshooting

### Приложение не появляется в menu bar

- Убедитесь, что `LSUIElement = YES` в Info.plist
- Проверьте, что приложение запущено (проверьте Activity Monitor)
- Перезапустите приложение

### Горячие клавиши не работают

- Убедитесь, что App Sandbox выключен
- Проверьте System Settings → Privacy & Security → Accessibility
- Добавьте Tahoe в разрешенные приложения

### История не сохраняется

- Проверьте права доступа к `~/Library/Application Support/Tahoe/`
- Убедитесь, что директория существует
- Проверьте консоль на ошибки (Console.app)

### Высокое потребление CPU

- Проверьте частоту polling в PasteboardMonitor (по умолчанию 0.5 сек)
- Уменьшите itemLimit в настройках
- Очистите историю (Clear All)

## Лицензия

Свободное использование для личных и коммерческих целей.

## Автор

Created with Claude - AI Assistant by Anthropic
Version 1.0 - 2025
